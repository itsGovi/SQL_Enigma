# The Journey Continues....ðŸ’¨ðŸƒ

---

### **Day-to-Day Reporting (Basic-Intermediate)**

1. [X] Identify employees hired in the last 90 days before **2024-01-01** and compare their individual engagement scores to the overall department-level engagement score. Return the employees whose engagement score exceeds their departmentâ€™s overall engagement score by more than 10%, along with their details such as `employee_id`, `full_name`, `department`, `position`, and `level`.
2. [X] Count the number of certifications by `industry_expertise` and `department`, then rank them by popularity within each `region`. Additionally, identify the top 3 most popular certifications across all regions, grouped by their `industry_expertise`.
3. [X] Identify the top 10 employees by total compensation within each of the 3 regions. For each of these employees, calculate their average billing rate and the percentage of total compensation they contribute within their region. Only include employees whose average billing rate exceeds the average billing rate of their respective region.
4. [X] Identify employees in the Americas region who have more than two active projects and an actual utilization > 85%. Additionally, calculate the percentage difference between each employee's actual utilization and their region's average actual utilization. Only include employees whose actual utilization is at least 10% higher than the regional average.
5. [X] For each department in the EMCA region, calculate the average project satisfaction of employees who have more than three active projects and actual utilization above 90%. Then, compare this department-level average with the overall company-wide average project satisfaction. Return only the departments where the average project satisfaction is below the company-wide average.
6. [X] Find employees whose `avg_team_size` exceeds the median team size of their department within their respective region. Additionally, ensure these employees have at least three active projects and an actual utilization above both their department and regional averages. Return their names, departments, regions, `avg_team_size`, and actual utilization.
7. [X] Identify **certifications** that have the **highest avg_innovation_score** **within each department** for  **entry-level employees** . Additionally, ensure that the **certification has been obtained by at least 5 employees** to avoid skewed results. Return the **certification name, department, and avg_innovation_score** sorted in descending order of innovation score.
8. [X] **Identify the top 3 departments** where the **average training hours of entry-level employees** is **above the overall median training hours** across all employees. Rank the departments by their average training hours in descending order. If multiple departments have the same average, break ties by the total number of employees in the department (higher count first). Return the department name, avg_training_hours, and employee_count.
9. [X] Calculate the total revenue generated by employees in the Client Services department, grouped by region. Use the following revenue formula for each employee:

â€ƒâ€ƒ           revenue = billing_rate * (actual_utilization / 100) * active_projects

    Additionally, only consider regions where at least 5 Client Services employees have contributed to the revenue calculation (to avoid skewed results).
       Return the region and the total revenue, sorted in descending order of revenue.

4. [ ] List employees whose knowledge_sharing_score is in the top 10% of their department.
5. [ ] Compute the percentage of employees in each specialization with more than one certification.
6. [ ] Identify departments with the smallest gaps between utilization_target and actual_utilization.
7. [ ] Display employees in the EMEA region sorted by retention_risk and delivery_quality.
8. [ ] Calculate avg_project_complexity by hire_year and compare trends across regions.
9. [ ] Find employees with direct_reports exceeding 5 and avg_project_satisfaction below 70.
1. [ ] List the top 5 primary_specializations by avg_performance_score and compare them across regions.
1. [ ] Identify employees with the highest flight_risk and their respective avg_training_hours.

* [X] **Advanced Utilization Ranking and Gap Analysis**

  Within each department, perform the following for each job level:

1. **Ranking:**
   Rank employees by their `avg_actual_utilization` (in descending order) using window functions, partitioned by both department and job level.
2. **Gap Calculation:**
   For each employee, compute a **utilization gap** defined as the difference between the maximum `avg_actual_utilization` in their department/job level group and their own `avg_actual_utilization`.
3. **Percentage Gap:**
   Calculate the **percentage gap** relative to the departmental maximum (i.e., `(max_utilization - employee_utilization) / max_utilization * 100`).
4. **Filtering Near-Top Performers:**
   Return only those employees whose **percentage gap** is less than or equal to 10%, highlighting near-top performers in their respective job levels.
5. **Final Output:**
   Return the following columns:
   * `employee_id`
   * `full_name`
   * `department`
   * `job_level`
   * `avg_actual_utilization`
   * `rank` (within department & job level)
   * `utilization_gap`
   * `percentage_gap`

* [X] Identify employees in the **APAC region** whose **average project duration** exceeds both:

  1. The **department average** across all regions.
  2. The **regional median project duration** (specific to APAC).

  Additionally, classify each employee into **tenure groups** based on their  **years of experience** :

  * **0â€“2 years:** "Junior"
  * **3â€“5 years:** "Mid-Level"
  * **6+ years:** "Senior"

  Ensure that:

  * Use **window functions** to calculate department-level averages and regional medians.
  * Use **recursive CTEs** to generate tenure groups dynamically.
  * Exclude employees who have worked on **fewer than 3 projects** to filter out anomalies.

  **Return:** Employee ID, Name, Department, Region, Avg_Project_Duration, Department_Avg_Duration, APAC_Regional_Median, Tenure_Group.
* [ ] **Advanced Employee Stability & Leadership Ranking**

  1. **Base Filter:**
     Identify employees with:
     * `flight_risk` below 20
     * `span_of_control` above 3
  2. **Department-Level Metrics:**
     For each department, calculate:
     * The **median flight_risk**
     * The **average span_of_control**
  3. **Relative Performance Calculation:**
     For each employee from the base filter:
     * Compute the  **flight risk deviation** :
       deviationrisk=department median flight riskâˆ’employee flight riskdepartment median flight risk\text{deviation}_{\text{risk}} = \frac{\text{department median flight risk} - \text{employee flight risk}}{\text{department median flight risk}}**deviation**risk=**department median flight risk**department median flight risk**âˆ’**employee flight risk****
     * Compute the  **span of control deviation** :
       deviationspan=employee span of controlâˆ’department average span of controldepartment average span of control\text{deviation}_{\text{span}} = \frac{\text{employee span of control} - \text{department average span of control}}{\text{department average span of control}}**deviation**span=**department average span of control**employee span of control**âˆ’**department average span of control****
     * Optionally, calculate a **composite score** (e.g., by summing the two deviations or using a weighted average).
  4. **Ranking:**
     Within each department, rank the employees by the composite score (with higher scores indicating significantly lower flight risk and significantly higher span of control relative to their department's benchmarks).
  5. **Final Output:**
     Return the top 3 employees per department, including:
     * Employee ID
     * Full Name
     * Department
     * Flight Risk
     * Span of Control
     * Department Median Flight Risk
     * Department Average Span of Control
     * Computed deviations (or composite score)
     * Their rank within the department

  **Return:**
  A result set sorted by department and rank.
* [ ] **Updated Question: Advanced Knowledge Sharing Analysis**

1. **Department-Level Threshold Calculation:**
   * For each department, compute the 90th percentile of the `knowledge_sharing_score` using a window function (e.g., `PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY knowledge_sharing_score)`) to establish a threshold.
2. **Employee Filtering:**
   * Identify employees whose `knowledge_sharing_score` exceeds their departmentâ€™s 90th percentile threshold.
3. **Composite Performance Metric:**
   * For each qualifying employee, calculate a composite performance metric that combines their `knowledge_sharing_score` and a fraction of their `training_hours` (for example, `composite_metric = knowledge_sharing_score + 0.5 * training_hours`).
4. **Ranking and Percentage Difference:**
   * Rank these employees within their department by their `knowledge_sharing_score` in descending order.
   * Additionally, compute the percentage difference between each employeeâ€™s score and the departmental 90th percentile threshold.
5. **Final Output:**
   * Return the following columns:
     * `employee_id`
     * `full_name`
     * `department`
     * `knowledge_sharing_score`
     * `training_hours`
     * `composite_metric`
     * `rank` (within department)
     * `percentage_difference` (i.e., how much higher the employee's score is compared to the threshold, expressed as a percentage)
   * Sort the results by department and then by rank (with the highest performers first).

---

### **Macro-Level Insights (Exploratory Queries)**

21. Compare the avg_delivery_quality across job levels and regions.
22. Analyze trends in training_hours for senior employees in Design & UX.
23. Compute the avg_project_duration for certifications related to Agile methodologies.
24. Identify employees in Product Strategy with actual_utilization consistently exceeding 90% YoY.
25. Analyze the relationship between knowledge_sharing_score and promotion_readiness across departments.
26. Compare avg_team_size for employees in Digital Transformation across regions.
27. Compute the correlation between avg_innovation_score and avg_project_complexity.
28. Rank certifications by their impact on avg_project_duration for employees in the Engineering Delivery department.
29. Identify employees in mid-level roles with the highest avg_engagement_score over time.
30. Explore avg_base_salary trends for employees grouped by industry_expertise and level.
31. List departments with the highest avg_actual_utilization and analyze their billing_rate trends.
32. Compute the avg_project_satisfaction for employees with a span_of_control labeled "Large."
33. Identify certifications with the lowest retention_risk and their avg_performance_score.
34. Compare the delivery_quality of employees in remote_work_ratio categories above and below 30%.
35. Analyze avg_engagement_score trends for employees who transitioned to higher job levels.
36. Compute the avg_project_satisfaction for employees managed by each manager_id.
37. Explore patterns in avg_billing_rate for employees grouped by industry_expertise.
38. Identify departments where avg_training_hours correlate strongly with avg_innovation_score.
39. Rank certifications by their avg_project_satisfaction within the Product Architecture department.
40. Compute the avg_project_complexity for employees with retention_risk marked "Medium" across all levels.

---

### **Advanced Analysis (Scenario-Based & Predictive Questions)**

41. Predict avg_promotion_readiness for employees in senior roles based on their avg_training_hours.
42. Simulate how a 10% increase in avg_project_duration might impact avg_engagement_score in the APAC region.
43. Forecast billing_rate trends for employees in Digital Transformation over the next five years.
44. Model how reducing avg_team_size by 10% affects avg_actual_utilization in the Americas.
45. Predict the impact of mandatory certifications on retention_risk across all job levels.
46. Simulate the avg_project_satisfaction changes if avg_project_complexity rises by 20%.
47. Forecast the flight_risk for employees with certifications in Cloud Infrastructure over three years.
48. Predict avg_project_satisfaction trends for employees transitioning from mid to senior levels.
49. Model the correlation between span_of_control and billing_rate across regions.
50. Analyze trends in avg_innovation_score for employees with a focus on Agile Delivery.
51. Simulate the impact of increasing avg_training_hours by 25% for employees in Product Strategy.
52. Predict avg_actual_utilization trends for employees in the EMEA region over five years.
53. Explore patterns in flight_risk for employees with three or more certifications.
54. Simulate how a 15% increase in certifications impacts avg_delivery_quality in Design & UX.
55. Analyze the retention_risk trends for departments grouped by avg_project_satisfaction.
56. Predict avg_project_duration changes for employees with a history of low avg_performance_score.
57. Forecast the certifications most likely to improve delivery_quality over the next two years.
58. Simulate the billing_rate trends if avg_project_complexity increases by 10%.
59. Predict the avg_engagement_score for employees with at least two certifications in Cloud Native.
60. Model how reducing flight_risk affects avg_innovation_score for employees in Engineering Delivery.

---

### **Deep Insights Discovery**

61. Identify departments most likely to benefit from avg_training_hours exceeding 50.
62. Explore trends in avg_project_duration for certifications grouped by industry_expertise.
63. Compute the avg_project_complexity for employees consistently meeting utilization_target YoY.
64. Identify employees whose avg_project_satisfaction significantly improves after obtaining Agile certifications.
65. Compare avg_engagement_score for employees in remote roles vs. office roles.
66. Rank certifications by their impact on flight_risk in mid-level roles.
67. Identify employees with consistently high avg_innovation_score and low billing_rate.
68. Compute avg_team_size for employees with more than 3 active_projects in each department.
69. Compare delivery_quality trends for employees grouped by job level and region.
70. Explore avg_project_duration changes for employees in senior roles with multiple specializations.
71. Identify departments with the smallest gaps between retention_risk and flight_risk.
72. Analyze avg_billing_rate trends for employees with certifications in Data Architecture.
73. Predict changes in engagement_score for employees with knowledge_sharing_score in the top quartile.
74. Simulate avg_delivery_quality changes with a 30% increase in avg_project_duration.
75. Rank industry_expertise fields by avg_project_satisfaction across departments.
76. Forecast avg_training_hours needed to reduce retention_risk in Digital Transformation.
77. Identify the most common certification paths for employees in Product Strategy.
78. Simulate avg_project_duration changes if active_projects double in Engineering Delivery.
79. Predict avg_team_size trends for departments with avg_innovation_score consistently above 80.
80. Analyze the avg_actual_utilization for employees in mid-level roles with high billing_rate.

---

### **Mastery-Level Challenges**

81. Model how avg_project_satisfaction changes with incremental increases in avg_project_complexity.
82. Predict avg_engagement_score trends for employees with low retention_risk and high span_of_control.
83. Explore avg_billing_rate patterns for employees in departments exceeding avg_training_hours.
84. Identify certifications with the strongest correlation to high avg_performance_score.
85. Simulate avg_delivery_quality changes with a 15% reduction in travel_percentage.
86. Forecast the impact of adding certifications on avg_project_duration trends.
87. Compute the avg_innovation_score for employees with low flight_risk and multiple certifications.
88. Simulate avg_project_satisfaction changes if avg_training_hours increase by 50%.
89. Predict avg_actual_utilization trends for departments with high avg_team_size.
90. Rank certifications by their impact on reducing retention_risk in the APAC region.
91. Identify employees in senior roles with low avg_performance_score and multiple active_projects.
92. Analyze the avg_billing_rate trends for employees with certifications related to Cloud Infrastructure.
93. Simulate avg_engagement_score changes if avg_project_satisfaction exceeds 85% across departments.
94. Compute avg_delivery_quality trends for employees grouped by hire_date decade.
95. Explore patterns in avg_project_complexity for employees in Product Architecture.
96. Analyze avg_training_hours trends for employees transitioning to higher job levels.
97. Predict avg_project_satisfaction trends for employees in regions with high avg_innovation_score.
98. Model the impact of increasing avg_team_size on avg_actual_utilization for senior managers.
99. Simulate avg_project_duration changes for employees with flight_risk labeled "High."
100. Forecast avg_billing_rate trends for employees in Design & UX over the next decade.

---

These 100 questions cover an extensive range of SQL challenges, building both theoretical understanding and practical skills necessary for real-world data analysis. Let me know if youâ€™d like tailored guidance for any question!

make the question a bit more hard -> increase the learning curve on that question and give me the updated version of it
