A refined **progressive SQL question set** that starts with practical, day-to-day reporting queries and transitions to macro-level analysis, exploration, and advanced data analysis (DA). The questions are structured to reflect real-world workflows in SQL, from simple reporting to deeper analytics.

---

### **Basic/Day-to-Day Reporting Queries (20 Questions)**

These are foundational questions, often required for regular reporting and operational insights.

1. [X] Retrieve all employees hired in the last 12 months.
2. [X] List the total number of employees in each department.
3. [X] Calculate the average `base_salary` by `region`.
4. [X] Identify employees who work remotely more than 30% of the time.
5. [X] Sort employees by their `hire_date` in ascending order.
6. [X] Find the top 5 employees with the highest `billing_rate` in the `APAC` region.
7. [X] Retrieve all employees with `actual_utilization` below 70%.
8. [X] List distinct job `positions` in the 'Product Architecture' department.
9. [X] Calculate the total `billing_rate` generated by employees in 'Engineering Delivery.'
1. [X] Count the number of certifications held by employees in each department.
1. [X] Identify employees in each department and position with a `flight_risk` greater than 50% and an `engagement_score` below 5.
1. [X] Display employees grouped by `job level` and calculate the total compensation for each group.
1. [X] Retrieve the details of employees whose `travel_percentage` exceeds the department average.
1. [X] Identify employees with no `direct_reports`.
1. [X] Rank employees by `delivery_quality` within their departments.
1. [X] List the `primary_specialization` and the number of employees in each specialization.
1. [X] Retrieve the top 3 certifications based on the number of employees holding them.
1. [X] Find employees whose `actual_utilization` is more than their department's `utilization_target`.
1. [X] Display all employees in the `senior` level sorted by their `project_satisfaction`.
2. [X] Retrieve all employees in the `APAC` region with `promotion_readiness` above 75%.

---

### **Intermediate/Exploratory Queries (30 Questions)**

2. [X] Analyze the `base_salary` distribution across regions, and compare it with the average `total_comp` of managers and non-managers in each region.
3. [X] compare the average `delivery_quality` of employees with the `AWS Solutions Architect` certification to those without it, within the department where this certification is present. The comparison should be based on the department and certification status."
4. [X] Explore the relationship between `remote_work_ratio` and `engagement_score` across regions, grouping employees by `job level`.
5. [X] Find employees whose certifications align perfectly with their `primary_specialization` and calculate their average `performance_score`.
6. [X] Compute the average `project_satisfaction` for departments with >= 3 `active_projects`, highlighting any outliers in satisfaction.
7. [X] Compare the `flight_risk` of employees across departments, grouping by `management_level` and `travel_percentage`.
8. [X] Identify employees whose `knowledge_sharing_score` exceeds the department average by 25% or more and list their `primary_specialization`.
9. [X] List underutilized employees (`actual_utilization` < `utilization_target`) with a `performance_score` greater than 4, ranking them by their `engagement_score`.
1. [X] Identify employees who have worked for more than 5 years but have a `retention_risk` of 'High' and analyze their `engagement_score`.
1. [ ] Compare the `promotion_readiness` of employees in 'Engineering Delivery' and 'Design & UX', highlighting those in the top quartile.
1. [ ] Determine departments with the highest standard deviation in `avg_project_complexity`.
1. [ ] Identify certifications commonly associated with employees having a `delivery_quality` above 90%.
1. [ ] Find employees with zero `mentorship_hours` but have more than 3 `team_lead_projects`.
1. [ ] List employees whose `billing_rate` exceeds the regional average and highlight their `primary_specialization`.
1. [ ] Determine the top 3 factors contributing to high `project_satisfaction` for employees in `Client Services`.
1. [ ] Analyze the correlation between `training_hours` and `promotion_readiness`, grouping by `job level`.
1. [ ] Calculate the average `engagement_score` by `primary_specialization`, comparing trends across regions.
1. [ ] Identify employees with at least two certifications and a `flight_risk` below 20%.
2. [ ] Compare the `knowledge_sharing_score` trends between `senior` and `entry` levels across all departments.
2. [ ] Analyze the trends in `actual_utilization` over the past two years for employees in the 'EMEA' region.
2. [ ] Explore patterns in certifications held by employees with a `delivery_quality` of 85% or higher.
2. [ ] Compare the distribution of `retention_risk` across regions, highlighting departments with an unusually high proportion of 'High' risk employees.
2. [ ] Identify employees whose `training_hours` are above the median for their department and analyze their `performance_score`.
2. [ ] Determine which employees consistently exceed the `utilization_target` for their department and list their `active_projects`.
2. [ ] Analyze the average `project_satisfaction` for employees managed by each `manager_id` across all regions.
2. [ ] Compare `engagement_score` and `billing_rate` trends for employees in mid-level roles across regions.
2. [ ] Highlight key differences in `innovation_score` across regions for employees in `Product Strategy`.
2. [ ] Calculate the average `span_premium` for employees managing more than 5 direct reports.
3. [ ] Explore trends in `team_lead_projects` for employees in `senior` versus `mid` levels.
3. [ ] Analyze the relationship between `remote_work_ratio` and `promotion_readiness` across all departments.

---

### **Advanced/Macro Analysis & Predictive Scenarios (40 Questions)**

51. Predict employees likely to achieve a `promotion_readiness` above 90% next year based on their current metrics.
52. Simulate how a 20% increase in `remote_work_ratio` might impact `engagement_score` in departments with more than 3 regions represented.
53. Forecast the `flight_risk` of employees with certifications in `TOGAF` based on current trends in their `performance_score`.
54. Predict how a 30% increase in `training_hours` could affect the average `performance_score` for `Engineering Delivery`.
55. Simulate the effect of increasing the `avg_team_size` by 50% on `delivery_quality` for employees in `Product Architecture`.
56. Analyze the impact of a 15% increase in `avg_project_duration` on `project_satisfaction` across all regions.
57. Forecast billing rate trends for employees in `Client Services` over the next three years.
58. Predict the likelihood of employees with `low retention_risk` transitioning to `medium retention_risk` in the next six months.
59. Simulate the impact of increasing certifications in `Mobile Development` on the `actual_utilization` of employees in `APAC`.
60. Forecast the most in-demand certifications over the next five years based on current trends in `certifications` held and `delivery_quality`.
61. Analyze patterns in `span_of_control` changes over time for `senior` managers across all regions.
62. Model how doubling the `management_premium` affects `delivery_quality` for managers in `EMEA`.
63. Predict changes in `knowledge_sharing_score` if employees in `Design & UX` increase `training_hours` by 25%.
64. Simulate how reducing the `retention_risk` to 'Low' for all employees with `engagement_score` above 8 impacts `delivery_quality`.
65. Forecast the distribution of `project_satisfaction` if all employees are assigned certifications in `Cloud Native`.
66. Analyze the correlation between `avg_project_complexity` and `billing_rate` changes over time.
67. Identify departments most likely to benefit from a 30% increase in `training_hours`.
68. Simulate how an increase in `direct_reports` by 2 for all managers would affect their `span_premium`.
69. Predict the impact of removing employees with `high retention_risk` on the overall `delivery_quality` in `Product Architecture`.
70. Explore trends in `utilization_target` fluctuations across `job levels` over the past five years.
71. Model how reducing `travel_percentage` by 10% affects `performance_score` for employees in `Americas`.
72. Predict the `flight_risk` for employees certified in both `Azure Architect` and `Scrum Master`.
73. Identify departments over-reliant on `senior-level` roles for delivering high `delivery_quality`.
74. Forecast `promotion_readiness` trends for employees based on their `certifications` and `training_hours`.
75. Simulate how increasing `billing_rate` by 15% for employees in `APAC` would affect total revenue.
76. Predict the effect of mandatory certifications on `engagement_score` for employees with `low retention_risk`.
77. Forecast changes in `retention_risk` for employees as their `knowledge_sharing_score` increases by 20%.
78. Analyze how trends in certifications affect `innovation_score` for employees in `Digital Transformation`.
79. Identify employees whose `span_of_control` qualifies them for promotion to senior management roles.
80. Simulate the effect of doubling `active_projects` for employees in `Engineering Delivery` on their `actual_utilization`.
81. Predict which departments will see the greatest improvement in `delivery_quality` with remote-friendly policies.
82. Analyze how certifications in `Microservices` impact `project_satisfaction` over time.
83. Forecast how adding new certifications impacts the `billing_rate` for employees in `Design & UX`.
84. Simulate the effect of increasing `avg_project_duration` by 10% on `actual_utilization` across regions.
85. Predict future trends in `flight_risk` for employees with three or more certifications.

---

These questions are structured to maximize exploration of the dataset, foster SQL skill development, and facilitate deep learning in data analysis. Let me know if further adjustments are needed!

make the question 5 a bit more hard -> increase the learning curve on that question and give me the updated version of it

"rather than your using words (plain english) I need you to find a similar case(scenario/question/problem-statement) to use a similar solution and break-it-down. So, I could build my query understanding your lesson"

### **Similar Scenario for Question 17** :

 **Scenario** :

Imagine a book database where each row contains a list of genres associated with a book (e.g., `"Fiction, Mystery, Thriller"`). Your task is to identify the top 3 most popular genres across all books by counting how many books belong to each genre.

---

### **Solution for Similar Scenario** :

1. **Problem Breakdown** :

* **Step 1** : Split the `genres` field (comma-separated values) into individual genres for each book.
* **Step 2** : Treat each genre as a separate entry for counting.
* **Step 3** : Group by individual genres and count the number of books associated with each genre.
* **Step 4** : Rank the genres by popularity (book count) and return the top 3 genres.

---

2. **Query Solution (for Books and Genres)** :

```sql
WITH exploded_genres AS (
    SELECT
        UNNEST(string_to_array(genres, ',')) AS genre
    FROM books
),
genre_counts AS (
    SELECT
        genre,
        COUNT(*) AS book_count,
        RANK() OVER (ORDER BY COUNT(*) DESC) AS genre_rank
    FROM exploded_genres
    GROUP BY genre
)
SELECT
    genre,
    book_count
FROM genre_counts
WHERE genre_rank <= 3;
```

---

### **Breakdown of the Query** :

1. **Step 1: Split and Unnest** :

* `string_to_array(genres, ',')`: Splits the comma-separated `genres` field into an array.
* `UNNEST()`: Converts the array into individual rows, each containing a single genre.

1. **Step 2: Group and Count** :

* `COUNT(*)`: Counts how many rows each genre appears in.
* `GROUP BY genre`: Groups the data by each individual genre.

1. **Step 3: Rank the Genres** :

* `RANK() OVER (ORDER BY COUNT(*) DESC)`: Assigns a rank to each genre based on its count, with the most popular genre ranked 1.

1. **Step 4: Filter Top 3 Genres** :

* `WHERE genre_rank <= 3`: Filters the result to include only the top 3 genres.

---

### **Apply This Lesson to Certifications** :

Replace:

* **`books`** with  **`employees`** .
* **`genres`** with  **`certifications`** .
* **`book_count`** with  **`employee_count`** .
